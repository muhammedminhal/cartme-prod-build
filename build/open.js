!function(t){var e={};function r(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(o,n,function(e){return t[e]}.bind(null,n));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=9)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class o extends Error{constructor(t,e="errCommon"){if(super(),this.isError=!1,Error.captureStackTrace(this,this.constructor),"errServer"==e&&(e="errCommon",console.log(`\n${new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})).toUTCString()} :-`),console.log(t)),"object"==typeof t){if(void 0!==t.errCommon&&(this.errCommon=t.errCommon),void 0!==t.errModuleWise&&(this.errModuleWise=t.errModuleWise),void 0!==t.HTTP_R_S_Code&&(this.HTTP_R_S_Code=t.HTTP_R_S_Code),void 0!==t.isError&&(this.isError=t.isError),t.errCommon||t.errModuleWise||t.HTTP_R_S_Code)return this;this[e]=[],t instanceof Error?(console.log(`\n${new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})).toUTCString()} :-`),console.log(t),this[e].push({strMessage:"SOMETHING_WENT_WRONG"})):this[e].push({strMessage:t.strMessage,objDetails:t.objDetails}),this.isError=!0}else t&&(this[e]=[],this[e].push({strMessage:t}),this.isError=!0)}add(t,e="errCommon"){if("errServer"==e&&(e="errCommon",console.log(`\n${new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})).toUTCString()} :-`),console.log(t)),"object"==typeof t){if(void 0!==t.errCommon&&(this.errCommon=t.errCommon),void 0!==t.errModuleWise&&(this.errModuleWise=t.errModuleWise),void 0!==t.HTTP_R_S_Code&&(this.HTTP_R_S_Code=t.HTTP_R_S_Code),t.errCommon||t.errModuleWise||t.HTTP_R_S_Code)return this;void 0===this[e]&&(this[e]=[]),t instanceof Error?(console.log(`\n${new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})).toUTCString()} :-`),console.log(t),this[e].push({strMessage:"SOMETHING_WENT_WRONG"})):this[e].push({strMessage:t.strMessage,objDetails:t.objDetails}),this.isError=!0}else void 0===this[e]&&(this[e]=[]),this[e].push({strMessage:t}),this.isError=!0}setStatus(t){return this.HTTP_R_S_Code=t,this}send({statusCode:t=400}={}){let e=[];return this.errCommon.length&&this.errCommon.forEach(t=>{e.push(t.strMessage)}),this.HTTP_R_S_Code&&(t=this.HTTP_R_S_Code),{body:{arrErrors:e},statusCode:t}}}e.default=o},function(t,e,r){"use strict";function o(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),o(r(6)),o(r(17)),o(r(18)),o(r(19)),o(r(7)),o(r(20))},function(t,e){t.exports=require("mongodb")},function(t,e,r){"use strict";function o(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),o(r(15)),o(r(16)),o(r(21)),o(r(24)),o(r(27)),o(r(29)),o(r(30)),o(r(31))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(41);let n=o.inserManyDBFactory();e.inserManyDB=n;let s=o.inserOneDBFactory();e.inserOneDB=s;let a=o.getListDBFactory();e.getListDB=a;let i=o.getOneDBFactory();e.getOneDB=i;let u=o.deleteDBFactory();e.deleteDB=u;let l=o.updateOneDBFactory();e.updateOneDB=l},function(t,e){t.exports=require("express")},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CLN_USER="cln_user",e.CLN_PRODUCT="cln_product",e.CLN_ORDER="cln_order",e.CLN_ORDER_TRACKING="cln_order_tracking",e.CLN_CATEGORY="cln_category",e.CLN_BRAND="cln_brand",e.CLN_PINCODE="cln_pincode",e.CLN_CART="cln_cart",e.CLN_MODE_PAYMENT="cln_mode_payment",e.CLN_COLOR_STOCK="cln_color_stock",e.CLN_SIZE_STOCK="cln_size_stock",e.CLN_MODULE_SETTINGS="cln_module_settings",e.CLN_ATTENDANCE="cln_attendance",e.CLN_DISTRIBUTER_INVENTORY="cln_distributer_inventory",e.CLN_EXECUTIVE_GEO_LOCATIONS="cln_executive_geo_location",e.CLN_NOTIFICATION="cln_notification",e.CLN_SALE_TARGET="cln_sale_target",e.CLN_LOCATION_TARGET="cln_location_target",e.CLN_PLAN="cln_plan",e.CLN_PAYMENTS="cln_payments"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.USER_RETAILER="RETAILER",e.USER_EMPLOYEE="EMPLOYEE",e.USER_ADMIN="ADMIN",e.USER_DISTRIBUTER="DISTRIBUTER",e.USER_CUSTOMER="CUSTOMER",e.USER_CLIENTS="CLIENTS",e.USER_USER="USER",e.USER_EMPLOYEE_EXECUTIVE="EXECUTIVE"},function(t,e){t.exports=require("axios")},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(5)),s=r(10),a=o(r(11)),i=o(r(12)),u=o(r(0)),l=o(r(13)),c=r(3),d=r(88),f=n.default();try{c.initilizeApp(),c.createMongoDbConnection(),f.use(i.default()),f.use(d.jwtTokenDecode),f.use(a.default.json()),f.use(a.default.urlencoded({limit:"50mb",extended:!0})),f.use((function(t,e,r,o){t instanceof SyntaxError&&"body"in t?r.status(400).send({errCommon:[{strMessage:"INVALID_JSON"}]}):o()})),f.use("/",l.default),f.listen(s.intPort,(function(){console.log("App is listening on port "+s.intPort)}))}catch(t){console.log(new u.default(t).send().body)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.intPort=4e3},function(t,e){t.exports=require("body-parser")},function(t,e){t.exports=require("cors")},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});let n=o(r(5)).default.Router();n.use("/user",r(14)),n.use("/product",r(52)),n.use("/master",r(66)),n.use("/common",r(77)),e.default=n},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(5)),s=r(3),a=r(34);let i=n.default.Router();i.post("/register_user",s.makeController(a.registerUserController)),i.post("/login_user",s.makeController(a.logInUserController)),i.post("/forgot_password",s.makeController(a.forgotPasswordController)),t.exports=i},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0));e.makeController=function(t){return async(e,r)=>{try{const o=await({body:e.body,query:e.query,params:e.params,ip:e.ip,strTenantId:e.strTenantId,strToken:e.strToken,strUserId:e.strUserId,strType:e.strType,method:e.method,timReceived:new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})),path:e.originalUrl,strAudience:(e.get("str-audience")||"").toUpperCase(),headers:{"Content-Type":e.get("Content-Type"),Referer:e.get("referer"),"User-Agent":e.get("User-Agent")}});console.log("TENANT"),console.log(e.strTenantId),console.log("ObjRequst Body\n :",new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))),console.log(e.body),await t(o).then(({headers:t={"Content-Type":"application/json","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))},type:e="json",statusCode:n=200,body:s})=>{if(!s)throw new Error("EMPTY_RESPONSE");r.set(t),r.type(e),400==n?r.status(n).send({...s,blnAPIStatus:!1}):r.status(n).send({...s,blnAPIStatus:!0,strToken:o.strToken})}).catch(async t=>{let e=new n.default(t).send();r.status(e.statusCode).set({"Content-Type":"application/json","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))}).send({...e.body,blnAPIStatus:!1})})}catch(t){let e=new n.default(t).send();r.status(e.statusCode).set({"Content-Type":"application/json","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))}).send({...e.body,blnAPIStatus:!1})}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(2),s=o(r(0)),a=r(1);let i;async function u(){try{i=await n.MongoClient.connect("mongodb+srv://abdut7:Rahman1**@cluster0.yoytl.mongodb.net/?retryWrites=true&w=majority&replicaSet=cluster0-shard-00-00.yoytl.mongodb.net:27017",{useUnifiedTopology:!0}),console.log("MongoClient Created")}catch(t){throw new s.default(t)}}e.createMongoDbConnection=u,e.getMongoDbConnection=async function(){try{return i||await u(),i.db(a.STR_COMMON_DB)}catch(t){throw new s.default(t)}},e.getMongoDbTransConnection=async function(){try{let t=await n.MongoClient.connect("mongodb+srv://abdut7:Rahman1**@cluster0.yoytl.mongodb.net/?retryWrites=true&w=majority&replicaSet=cluster0-shard-00-02.yoytl.mongodb.net:27017",{useUnifiedTopology:!0}),e=await t.db(a.STR_COMMON_DB),r=await t.startSession();return await r.startTransaction({readConcern:{level:"snapshot"},writeConcern:{w:"majority"}}),{objTransactionClient:t,objConnection:e,objSession:r}}catch(t){throw new s.default(t)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.USER_MODULE="mdl_user"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.STR_COMMON_DB_TENANT_ID="CART_ME",e.STR_COMMON_DB="CART_ME",e.STR_TENANT_ADMIN="ADMIN",e.RAZORPAY_KEY_ID="rzp_test_J4yJu6P408X3JK",e.RAZORPAY_SECERT_ID="33bR9V4aEk2i0cuyZGDvIOeo",e.INT_ESTIMATE_DELIVERY_DAYS=10,e.INT_MAX_MASTER_IMAGE_SIZE=100,e.INT_MAX_PRODUCT_IMAGE_SIZE=512,e.INT_MAX_PROFILE_IMAGE_SIZE=50,e.AWS_ACCESS_KEY_ID="AKIAIQTTA5K5RDRQKOIQ",e.AWS_SECRET_ACCESS_KEY="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",e.AWS_S3_LOCATION="ap-south-1",e.AWS_S3_MASTER_BUCKET="axef",e.AWS_BUCKET_URL="https://axef.s3.ap-south-1.amazonaws.com/",e.SMS_API_KEY="c746d967-eb3c-11ea-9fa5-0200cd936042",e.objModuleSettings={strTenantId:"",strName:"mdl_home",strTheame:"BASIC",chrStatus:"T",objProduct:{strSortOrder:"ASC",strSortBy:"strName",blnPriceShow:!0,blnQualityShow:!0},objShop:{blnLogoShow:!0,blnCoverImageShow:["https://axef.s3.ap-south-1.amazonaws.com/0mdlmaster1599550718277.webp"],strLogoUrl:["https://axef.s3.ap-south-1.amazonaws.com/0mdlmaster1599547718936.webp"],strCoverImage:["https://axef.s3.ap-south-1.amazonaws.com/0mdlmaster1599550718277.webp"],strBGColor:"#000FFA",blnAboutShow:!0,strAbout:"YOUR SHOPE DISCRIPTION",strTittle:"YOUR SHOPE NAME",blnTextItalic:!0,blnTextUnderline:!0,blnTextBold:!0,strMobileNumber:""},objCart:{blnOrderChargeShow:!0,blnExtraChargeShow:!0,strOrderMessage:"Order Message",blnGSTField:!1,arrExtraTextBoxes:[{strHead:"PIN CODE",strKey:"strPinCode",strType:"S"}]}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.STR_PENDING="PENDING",e.STR_SEND="SEND",e.STR_UNSHIPPED="UNSHIPPED",e.STR_CANCEL="CANCEL",e.STR_RETURNED="RETURNED",e.STR_REFUNDED="REFUNDED",e.OBJ_ORDER_PRIORITY={PENDING:!0,SEND:!0,UNSHIPPED:!0,DELIVERED:!0,CANCEL:!0,RETURNED:!0,REFUNDED:!0,DELETE:!0}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.objPlan={DEMO:{intProductCount:70,intCategoryCount:10,blnMultiProductImages:!1,blnProductDetails:!0,blnDataExport:!0,blnMultiBanner:!0,blnMultiVariance:!0},BASIC:{intProductCount:50,intCategoryCount:5,blnMultiProductImages:!1,blnProductDetails:!1,blnDataExport:!1,blnMultiBanner:!1,blnMultiVariance:!1,blnProductZoom:!1},SILVER:{intProductCount:50,intCategoryCount:5,blnMultiProductImages:!1,blnProductDetails:!1,blnDataExport:!1,blnMultiBanner:!1,blnMultiVariance:!1,blnProductZoom:!1},GOLD:{intProductCount:100,intCategoryCount:10,blnMultiProductImages:!0,blnProductDetails:!0,blnDataExport:!0,blnMultiBanner:!0,blnMultiVariance:!0,blnProductZoom:!0},PLATINUM:{intProductCount:-1,intCategoryCount:-1,blnMultiProductImages:!0,blnProductDetails:!0,blnDataExport:!0,blnMultiBanner:!0,blnMultiVariance:!0,blnProductZoom:!0}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(22)),s=o(r(23)),a=o(r(0));e.hashString=function(t){return new Promise((function(e,r){try{t.length>0?n.default.genSalt(10,(function(r,o){n.default.hash(t,o,(function(t,r){e(r)}))})):r("NULL_INPUT_RECVD")}catch(t){throw new a.default(t)}}))},e.compareHashAndText=function(t,e){return new Promise((async function(r,o){try{if(t&&e){r(await n.default.compareSync(t,e))}else o("NULL_INPUT_RECVD")}catch(t){throw new a.default(t)}}))},e.encryptString=async function(t){return t?(await s.default.AES.encrypt(t,"cartme123")).toString():t},e.decryptString=async function(t){if(!t)return t;console.log("11"),console.log(t);let e=await s.default.AES.decrypt(t,"cartme123");return console.log("12"),console.log(e.toString(s.default.enc.Utf8)),console.log("12"),e.toString(s.default.enc.Utf8)}},function(t,e){t.exports=require("bcryptjs")},function(t,e){t.exports=require("crypto-js")},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(25)),s=o(r(0)),a=o(r(26));e.jwtSignIn=async function(t,e){try{let r=await a.default.readFileSync("./config/private.key","utf-8"),o=await({issuer:e.issuer,subject:e.subject,audience:e.audience,algorithm:"RS256"});return await n.default.sign(t,r,o)}catch(t){throw new s.default(t)}},e.jwtVerify=async function(t,e){try{let r=await a.default.readFileSync("./config/public.key","utf-8"),o={issuer:e.issuer,subject:e.subject,audience:e.audience,algorithm:"RS256",expiresIn:"300d"};return n.default.verify(t,r,o)}catch(t){throw new s.default(t)}},e.jwtDecode=async function(t){try{return n.default.decode(t,{complete:!0})}catch(t){throw new s.default(t)}}},function(t,e){t.exports=require("jsonwebtoken")},function(t,e){t.exports=require("fs")},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(28)),s=o(r(0));async function a(){try{return await n.default.createClient()}catch(t){throw new s.default(t)}}e.initializeRedisConn=a,e.setRedisData=async function(t,e){let r=await a();try{return await r.on("error",(function(t){console.error(t)})),r.set(t,e,n.default.print)}catch(t){throw new s.default(t)}finally{await r.quit()}},e.getRedisData=async function(t){let e=await a();return new Promise((function(r,o){try{e.get(t,(function(t,e){e&&r(e),r(null)}))}catch(t){o(new s.default(t))}finally{e.quit()}}))},e.checkPartialKeyExist=async function(t){let e=await a();return new Promise((function(r,o){try{return e.keys(t+"*",(function(t,e){e&&r(e),r(null)}))}catch(t){o(new s.default(t))}finally{e.quit()}}))}},function(t,e){t.exports=require("redis")},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(2),s=o(r(0)),a=r(1);e.objTenantConfig={},e.objOpenAPI={},e.initilizeApp=async function(){console.log("Initiliz");let t=await n.MongoClient.connect("mongodb+srv://abdut7:Rahman1**@cluster0.yoytl.mongodb.net/?retryWrites=true&w=majority&replicaSet=cluster0-shard-00-00.yoytl.mongodb.net:27017",{useUnifiedTopology:!0});console.log("client");let r=await t.db(a.STR_COMMON_DB);console.log("DB");try{let o,n;o=await r.collection("tenantConfig").find({}).toArray(),await o.forEach(t=>{e.objTenantConfig[t.strTenantId]=t}),n=await r.collection("openAPI").find({}).toArray(),await n.forEach(t=>{e.objOpenAPI[t.strEndPoint]=!0})}catch(t){throw new s.default(t)}finally{t.close()}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0));e.makeFileController=function(t){return(e,r)=>{try{const o={body:e.body,file:e.file,files:e.files,query:e.query,params:e.params,ip:e.ip,strTenantId:e.strTenantId,authorization:e.get("x-access-token"),strUserId:e.strUserId,method:e.method,timReceived:new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})),path:e.originalUrl,strAudience:(e.get("str-audience")||"").toUpperCase(),headers:{"Content-Type":e.get("Content-Type"),Referer:e.get("referer"),"User-Agent":e.get("User-Agent")}};t(o).then(({headers:t={"Content-Type":"text/plain","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))},type:e="json",statusCode:o=200,body:n})=>{if(!n)throw new Error("EMPTY_RESPONSE");r.set(t),r.type(e),400==o&&r.status(o).send({...n,blnAPIStatus:!1}),r.status(o).send({...n,blnAPIStatus:!0})}).catch(t=>{let e=new n.default(t).send();r.status(e.statusCode).set({"Content-Type":"application/json","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))}).send({...e.body,blnAPIStatus:!1})})}catch(t){let e=new n.default(t).send();r.status(e.statusCode).set({"Content-Type":"application/json","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))}).send({...e.body,blnAPIStatus:!1})}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(1),s=o(r(32)),a=o(r(33)),i=o(r(0));e.multiFilesToS3=async function({arrFiles:t,strType:e=null,strQuality:r,strFileNames:o=""}){try{await s.default.config.update({accessKeyId:n.AWS_ACCESS_KEY_ID,secretAccessKey:n.AWS_SECRET_ACCESS_KEY,region:n.AWS_S3_LOCATION});let i=await new s.default.S3,u=[],l="mdlmaster"+Date.now(),c=".jpg",d=o.split("#");for(let o=0;o<t.length;o++){const s=t[o];let f=s.name.split(".");c=f[f.length-1],"BULK_IMPORT"==e&&(l=d[o+1]),await u.push(`${n.AWS_BUCKET_URL}${o}${l}.webp`),r?a.default(s.data).resize(r).toBuffer().then(t=>{i.putObject({Bucket:n.AWS_S3_MASTER_BUCKET,Body:t,Key:`${o}${l}.webp`,ACL:"public-read"},(function(t,e){t&&console.log("Error uploading data: ",t)}))}).catch(t=>{console.log("err"),console.log(t)}):a.default(s.data).toBuffer().then(t=>{i.putObject({Bucket:n.AWS_S3_MASTER_BUCKET,Body:t,Key:`${o}${l}.webp`,ACL:"public-read"},(function(t,e){t&&console.log("Error uploading data: ",t)}))}).catch(t=>{console.log("err"),console.log(t)})}return{arrImageUrl:u}}catch(t){throw new i.default(t)}}},function(t,e){t.exports=require("aws-sdk")},function(t,e){t.exports=require("sharp")},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(35),n=r(36);let s=o.registerUserControllerFactory({registerUserUsecase:n.registerUserUsecase,updateUserUsecase:n.updateUserUsecase});e.registerUserController=s;let a=o.logInUserControllerFactory({logInUserUseCase:n.logInUserUseCase});e.logInUserController=a;let i=o.getListUserControllerFactory({getListUserUsecase:n.getListUserUsecase});e.getListUserController=i;let u=o.inActivateUserControllerFactory({inActivateUserUsecase:n.inActivateUserUsecase});e.inActivateUserController=u;let l=o.deleteUserControllerFactory({deleteUserUsecase:n.deleteUserUsecase});e.deleteUserController=l;let c=o.forgotPasswordControllerFactory({forgotPasswordUsecase:n.forgotPasswordUsecase});e.forgotPasswordController=c;let d=o.changePasswordControllerFactory({changePasswordUsecase:n.changePasswordUsecase});e.changePasswordController=d},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0));e.registerUserControllerFactory=function({registerUserUsecase:t,updateUserUsecase:e}){return async function({body:r,...o}){try{return{body:"UPDATE"==r.strOperationType?await e({source:o,body:r}):await t({source:o,body:r})}}catch(t){return new n.default(t).send()}}},e.getListUserControllerFactory=function({getListUserUsecase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}},e.logInUserControllerFactory=function({logInUserUseCase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}},e.forgotPasswordControllerFactory=function({forgotPasswordUsecase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}},e.changePasswordControllerFactory=function({changePasswordUsecase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}},e.inActivateUserControllerFactory=function({inActivateUserUsecase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}},e.deleteUserControllerFactory=function({deleteUserUsecase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(37),s=r(39),a=r(4),i=o(r(42)),u=o(r(43)),l=o(r(44)),c=o(r(45)),d=o(r(46)),f=o(r(47)),_=o(r(48)),y=o(r(49)),h=o(r(50)),S=o(r(51));let C=h.default(),M=y.default(),b=i.default({registerUserDb:n.registerUserDb,inserOneDB:a.inserOneDB,userEntity:s.userEntity});e.registerUserUsecase=b;let p=u.default({getUserDetailsDb:n.getUserDetailsDb});e.logInUserUseCase=p;let D=f.default({deleteDB:a.deleteDB});e.deleteUserUsecase=D;let g=l.default({getListUserDB:n.getListUserDB});e.getListUserUsecase=g;let T=d.default({inActivateUserUserDB:n.inActivateUserUserDB});e.inActivateUserUsecase=T;let w=c.default({userUpdateEntity:s.userUpdateEntity,updateUserDb:n.updateUserDb});e.updateUserUsecase=w;let I=_.default({userEntity:s.userEntity,inserManyDB:a.inserManyDB,getUserDetailsDb:n.getUserDetailsDb,registerUserDb:n.registerUserDb,updateOneDB:a.updateOneDB,sendOTPUsecase:M,verifyOTPUsecase:C});e.forgotPasswordUsecase=I;let E=S.default({getUserDetailsDb:n.getUserDetailsDb});e.changePasswordUsecase=E},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(38);let n=o.registerUserDbFactory();e.registerUserDb=n;let s=o.getUserDetailsDbFactory();e.getUserDetailsDb=s;let a=o.getListUserDBFactory();e.getListUserDB=a;let i=o.updateUserDbFactory();e.updateUserDb=i;let u=o.inActivateUserUserDBFactory();e.inActivateUserUserDB=u},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(3),s=o(r(0)),a=r(1),i=r(2);e.registerUserDbFactory=function(){return async function({objUser:t}){let e=await n.getMongoDbConnection();try{return await e.collection(a.CLN_USER).insertOne(t),{strMessage:"Success"}}catch(t){let e={strName:"USER NAME ALREADY EXIST",strMobileNo:"MOBILE NUMBER ALREADY EXIST",strEmail:"EMAIL ALREADY EXIST",strTenantId:"EMAIL ALREADY EXIST"},r=new s.default;if("MongoError"==t.name&&"11000"==t.code&&(t.keyValue.strName&&r.add(e.strName),t.keyValue.strMobileNo&&r.add(e.strMobileNo),t.keyValue.strTenantId&&r.add(e.strTenantId),t.keyValue.strTenantId&&r.add(e.strTenantId),r.isError))throw r;throw new s.default(t)}}},e.updateUserDbFactory=function(){return async function({objQuery:t,objSetUser:e,strTenantId:r}){let o=await n.getMongoDbConnection();try{return(await o.collection(a.CLN_USER).findOneAndUpdate(t,e)).value}catch(t){let e={strName:"USER NAME ALREADY EXIST",strMobileNo:"MOBILE NUMBER ALREADY EXIST",strEmail:"EMAIL ALREADY EXIST"},r=new s.default;if("MongoError"==t.name&&"11000"==t.code&&(t.keyValue.strName&&r.add(e.strName),t.keyValue.strMobileNo&&r.add(e.strMobileNo),t.keyValue.strEmail&&r.add(e.strEmail),r.isError))throw r;throw new s.default(t)}}},e.getListUserDBFactory=function(){return async function({strTenantId:t,arrQuery:e,strType:r}){let o=await n.getMongoDbConnection();try{let t=await o.collection(a.CLN_USER).aggregate(e).toArray();return t.length?(e.pop(),e.pop(),e.push({$count:"intTotalCount"}),{arrList:t,objCount:await o.collection(a.CLN_USER).aggregate(e).toArray()}):{arrList:t,objCount:[{intTotalCount:0}]}}catch(t){throw new s.default(t)}}},e.inActivateUserUserDBFactory=function(){return async function({objUpdateUser:t,strUserDocId:e}){let r=await n.getMongoDbConnection();try{return await r.collection(a.CLN_USER).findOneAndUpdate({_id:new i.ObjectID(e)},{$set:t}),{}}catch(t){throw new s.default(t)}}},e.getUserDetailsDbFactory=function(){return async function({strName:t=null,strMobileNo:e=null,strUserPK:r=null,objSetCart:o=null,strActiveStatus:u=null}){let l=await n.getMongoDbConnection();try{let n={chrStatus:"N"};u&&(n.strActiveStatus="A"),t?n.strName=t:e?n.strMobileNo=e:r&&(n._id=new i.ObjectID(r));let c={};if(o){if(c=await l.collection(a.CLN_USER).findOneAndUpdate(n,o),!c.value)throw new s.default("INVALID_USER_NAME");return c.value}if(c=await l.collection(a.CLN_USER).findOne(n),!c)throw new s.default("INVALID_USER_NAME");return c}catch(t){throw new s.default(t)}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(40);let n=o.userEntityFactory();e.userEntity=n;let s=o.userUpdateEntityFactory();e.userUpdateEntity=s},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(1),s=o(r(0)),a=r(4),i=r(3),u=r(2);e.userEntityFactory=function(){return async function({strName:t,strMobileNo:e,strEmail:r,strPassword:o,strShopeName:l,strPlan:c,strCreatedTime:d,strCreatedUser:f}){try{let _=new s.default;if(l||_.add("SHOPE_NAME_MISSING"),!t&&t.length<4&&_.add("NAME_LENGTH_LESS"),!e&&e.length<9&&_.add("MOBILE_NO_LESS"),!o&&o.length<5&&_.add("PASSWORD_ERROR"),_.isError)throw _;{if(await a.getOneDB({strCollection:n.CLN_USER,objQuery:{chrStatus:"N",strName:t}})&&_.add("NAME  ALREADY EXISTS "),await a.getOneDB({strCollection:n.CLN_USER,objQuery:{chrStatus:"N",strTenantId:l}})&&_.add("SHOP NAME  ALREADY EXISTS "),await a.getOneDB({strCollection:n.CLN_USER,objQuery:{chrStatus:"N",strMobileNo:e}})&&_.add(" MOBILE NUMBER ALREADY EXISTS "),_.isError)throw _;let s=await i.hashString(o.trim()),y=n.objModuleSettings;return y.strUserName=t,y.strTenantId=l,y.objShop.strMobileNumber=e,{objPlan:{strPlan:c||"DEMO",chrStatus:"N",strTenantId:l,strCreatedTime:d||null,strCreatedUser:new u.ObjectID(f)||null},objNewModuleSettings:y,objUser:{strName:t,strMobileNo:e,strEmail:r||"",strHashPassword:s,strActiveStatus:"A",strType:"CLIENTS",chrStatus:"T",strPlan:c||"DEMO",strTenantId:l,strCreatedTime:d||null,strCreatedUser:new u.ObjectID(f)||null}}}}catch(t){throw new s.default(t)}}},e.userUpdateEntityFactory=function(){return async function({_id:t,strName:e,strType:r,strEmail:o,strImageUrl:a,arrAddress:i,strModifiedTime:l,strModifiedUser:c}){try{let d=new s.default;if(t||d.add("_ID_MISSING"),!e&&e.length<4&&r!=n.USER_RETAILER&&d.add("NAME_LENGTH_LESS"),d.isError)throw d;return{_id:new u.ObjectID(t),objUser:{strName:e,strEmail:o,strImageUrl:a||"",arrAddress:i||[],strModifiedTime:l||null,strModifiedUser:new u.ObjectID(c)||null}}}catch(t){throw new s.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(3),s=o(r(0));e.getListDBFactory=function(){return async function({strCollection:t,arrQuery:e}){try{return(await n.getMongoDbConnection()).collection(t).aggregate(e).toArray()}catch(t){throw new s.default(t)}}},e.getOneDBFactory=function(){return async function({strCollection:t,objSet:e=null,objQuery:r}){try{let o=await n.getMongoDbConnection();if(e){return(await o.collection(t).findOneAndUpdate(r,{$set:e})).value}return o.collection(t).findOne(r)}catch(t){throw new s.default(t)}}},e.inserManyDBFactory=function(){return async function({strCollection:t,arrInsertDocuments:e}){try{let r=await n.getMongoDbConnection();return await r.collection(t).insertMany(e),{strMessage:"Success"}}catch(t){throw new s.default(t)}}},e.inserOneDBFactory=function(){return async function({strCollection:t,objDocument:e}){try{return(await n.getMongoDbConnection()).collection(t).insertOne(e)}catch(t){throw new s.default(t)}}},e.updateOneDBFactory=function(){return async function({strCollection:t,objQuery:e,objDocument:r}){try{let o=await n.getMongoDbConnection();return await o.collection(t).updateOne(e,{$set:r}),{strMessage:"UPDATE_SUCCESS"}}catch(t){throw new s.default(t)}}},e.deleteDBFactory=function(){return async function({strCollection:t,arrDeleteId:e,strModifiedTime:r,strModifiedUser:o}){let a=await n.getMongoDbConnection();try{if((await a.collection(t).find({_id:{$in:e}}).toArray()).length!=e.length)throw new s.default("ITEM_MISMACTH");return await a.collection(t).updateMany({_id:{$in:e}},{$set:{chrStatus:"D",strModifiedTime:r,strModifiedUser:o}}),{}}catch(t){throw new s.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(6),s=o(r(0));e.default=function({inserOneDB:t,userEntity:e,registerUserDb:r}){return async function({source:o,body:a}){try{let s=await e({...a,strCreatedTime:o.timReceived,strCreatedUser:o.strUserId});console.log(["objNewModuleSettings"]),console.log(s.objNewModuleSettings);let i=await t({strCollection:n.CLN_MODULE_SETTINGS,objDocument:s.objNewModuleSettings});return console.log("objRes\n\n"),console.log(i),r({objUser:s.objUser})}catch(t){throw new s.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(3),s=o(r(0)),a=r(1);e.default=function({getUserDetailsDb:t}){return async function({source:e,body:r}){if((r.strName||r.strMobileNo)&&!r.strPassword)throw new s.default("CREDENTIAL_MISSING");let o=await t({strName:r.strName||null,strMobileNo:r.strMobileNo||null,strActiveStatus:"A"}),i="";if(o.strType!=r.strType)throw new s.default("YOU HAVE NO PERMISSION IN DASHBOARD");if(!await n.compareHashAndText(r.strPassword,o.strHashPassword))throw new s.default("CREDENTIAL_INVALID");return i=await n.jwtSignIn({strUserId:o._id.toString(),strName:o.strName,strType:o.strType},{issuer:"CARTME",subject:"123",audience:a.STR_COMMON_DB_TENANT_ID}),await n.setRedisData(i,o.strTenantId),await delete o.strHashPassword,{strToken:i,strEncryptToken:i,...o}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(7),s=o(r(0)),a=r(1),i=r(2);e.default=function({getListUserDB:t}){return async function({source:e,body:r}){try{let o={$and:[]};if(o.$and.push({chrStatus:"N"}),r.strDocId&&o.$and.push({_id:new i.ObjectID(r.strDocId)}),!r.strType)throw new s.default("INVALID_USER_TYPE","errCommon");o.$and.push({strType:r.strType}),r.strType==n.USER_CLIENTS&&o.$and.push({strType:n.USER_CLIENTS}),r.strType==n.USER_USER&&(o.$and.push({strType:n.USER_USER}),o.$and.push({strTenantId:e.strTenantId}),o.$and.push({chrOrderUser:"T"}),r.strSearch&&o.$and.push({strCustomerName:{$regex:""+r.strSearch,$options:"i"}})),r.strType==n.USER_ADMIN&&(o.$and.push({strType:n.USER_CLIENTS}),o.$and.push({strTenantId:e.strTenantId}));let u=[];if(u.push({$match:o}),r.strSort){let t={$sort:{[r.strSort]:"ASC"==r.strSortActive?1:-1}};u.push(t)}else u.push({$sort:{strCreatedTime:-1}});let l=Number(r.intPageNo)*Number(r.intLimit);await u.push({$limit:l+Number(r.intLimit)||80}),await u.push({$skip:l||0});let c=await t({strTenantId:e.strTenantId||a.STR_COMMON_DB_TENANT_ID,arrQuery:u});return{...r,intTotalCount:c.objCount[0]?c.objCount[0].intTotalCount:0,arrList:c.arrList}}catch(t){throw new s.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0)),s=r(1),a=r(2);e.default=function({userUpdateEntity:t,updateUserDb:e}){return async function({source:r,body:o}){try{let n=await t({...o,strTenantId:r.strTenantId||s.STR_COMMON_DB_TENANT_ID,strModifiedTime:r.timReceived,strModifiedUser:r.strUserId}),i={};switch(o.strType){case s.USER_ADMIN:i={strWhatsAppNumber:o.strWhatsAppNumber||null};break;case s.USER_CUSTOMER:default:i={}}return await e({objQuery:{_id:new a.ObjectID(n._id)},objSetUser:{$set:{...n.objUser,...i}},strTenantId:r.strTenantId||s.STR_COMMON_DB_TENANT_ID}),{strMessage:"Success"}}catch(t){throw new n.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0));e.default=function({inActivateUserUserDB:t}){return async function({source:e,body:r}){try{let e=r.strUserDocId;if(!e)throw new n.default("INVALID_ID");let o={strActiveStatus:r.strActiveStatus||"I"};return await t({objUpdateUser:o,strUserDocId:e}),{strMessage:"Success"}}catch(t){throw new n.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(1),s=o(r(0)),a=r(2);e.default=function({deleteDB:t}){return async function({source:e,body:r}){try{let o=[];return r.arrDeleteId.forEach(t=>{o.push(new a.ObjectID(t))}),await t({arrDeleteId:o,strCollection:n.CLN_USER,strModifiedTime:e.timReceived,strModifiedUser:e.strUserId}),{strMessage:"DELETE_SUCCESS"}}catch(t){throw new s.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(3),s=o(r(0)),a=r(1);e.default=function({inserManyDB:t,userEntity:e,getUserDetailsDb:r,updateOneDB:o,sendOTPUsecase:i,registerUserDb:u,verifyOTPUsecase:l}){return async function({source:c,body:d}){if("REGISTER"==d.strStep){if(!d.strMobileNo)throw new s.default("MOBILE_MISSING");let r=await e({...d,strTenantId:c.strTenantId,strCreatedTime:c.timReceived,strCreatedUser:c.strUserId});console.log(["objNewModuleSettings"]),console.log(r.objNewModuleSettings);let o=await t({strCollection:a.CLN_MODULE_SETTINGS,arrInsertDocuments:[r.objNewModuleSettings]});return console.log("objRes\n\n"),console.log(o),await u({objUser:r.objUser}),await i({source:c,objSMSAPI:{strMobileNo:d.strMobileNo}})}if("FORGOT"==d.strStep){if(!d.strName)throw new s.default("USER_NAME_MISSING");let t=await r({strName:d.strName||null,strMobileNo:d.strMobileNo||null,strTenantId:a.STR_COMMON_DB_TENANT_ID});if(!t.strName)throw new s.default("INVALID_USER");return{...await i({source:c,objSMSAPI:{strMobileNo:t.strMobileNo}}),strName:d.strName,strMobileNo:t.strMobileNo}}if("VERIFY"==d.strStep){if(!d.strName)throw new s.default("USER_NAME_MISSING");if(!d.strSessionId)throw new s.default("OTP_SESSION_MISSING");d.strRegister&&await o({strCollection:a.CLN_USER,objQuery:{strName:d.strName,chrStatus:"T"},objDocument:{chrStatus:"N"}});let t=await l({source:c,objSMSAPI:{strSessionId:d.strSessionId,strOTP:d.strOTP}}),e={};if("OTP Matched"==await t){if(e=await r({strName:d.strName||null,strMobileNo:d.strMobileNo||null}),d.strRegister){let t=a.objModuleSettings;t.strTenantId=c.strTenantId,t.objShop.strMobileNumber=d.strMobileNo,t.objShop.strTittle=d.strName,await o({strCollection:a.CLN_MODULE_SETTINGS,objQuery:{strUserName:d.strName,chrStatus:"T"},objDocument:{chrStatus:"N"}})}else{if(!d.strPassword&&d.strPassword.length<5)throw new s.default("PASSWORD_ERROR");let t={$set:{strHashPassword:await n.hashString(d.strPassword.trim())}};e=await r({strName:d.strName||null,strMobileNo:d.strMobileNo||null,objSetCart:t,strTenantId:a.STR_COMMON_DB_TENANT_ID})}return{...e}}throw new s.default("INVALID OTP")}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0)),s=o(r(8)),a=r(1);e.default=function(){return async function({source:t,objSMSAPI:e}){try{return(await s.default.get(`http://2factor.in/API/V1/${a.SMS_API_KEY}/SMS/${e.strMobileNo}/AUTOGEN`)).data}catch(t){throw new n.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0)),s=o(r(8)),a=r(1);e.default=function(){return async function({source:t,objSMSAPI:e}){try{return(await s.default.get(`https://2factor.in/API/V1/${a.SMS_API_KEY}/SMS/VERIFY/${e.strSessionId}/${e.strOTP}`)).data.Details}catch(t){throw new n.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(3),s=o(r(0));e.default=function({getUserDetailsDb:t}){return async function({source:e,body:r}){if(!r.strPassword&&r.strPassword.length<5)throw new s.default("PASSWORD_ERROR");let o={$set:{strHashPassword:await n.hashString(r.strPassword.trim())}};return{...await t({strUserPK:e.strUserId||null,objSetCart:o,strTenantId:e.strTenantId})}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(5)),s=r(3),a=r(53);let i=n.default.Router();i.post("/get_product",s.makeController(a.getListProductController)),i.post("/get_product_details",s.makeController(a.getProductDetailsController)),t.exports=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(54),n=r(65);let s=n.createProductControllerFactory({createProductUsecase:o.createProductUsecase});e.createProductController=s;let a=n.getListProductControllerFactory({getListProductUsecase:o.getListProductUsecase});e.getListProductController=a;let i=n.getListProductCartControllerFactory({getListProductCartUsecase:o.getListProductCartUsecase});e.getListProductCartController=i;let u=n.getProductDetailsControllerFactory({getProductDetailsUsecase:o.getProductDetailsUsecase});e.getProductDetailsController=u;let l=n.deleteProductControllerFactory({deleteProductUsecase:o.deleteProductUsecase});e.deleteProductController=l;let c=n.importProductControllerFactory({importProductUsecase:o.importProductUsecase});e.importProductController=c},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(55),s=r(4),a=r(57),i=o(r(59)),u=o(r(60)),l=o(r(61)),c=o(r(62)),d=o(r(63)),f=o(r(64));let _=i.default({productEntity:n.productEntity,deleteProductDB:a.deleteProductDB,createProductDB:a.createProductDB});e.createProductUsecase=_;let y=u.default({getListProductDB:a.getListProductDB});e.getListProductUsecase=y;let h=f.default({getListDB:s.getListDB,getListProductDB:a.getListProductDB});e.getListProductCartUsecase=h;let S=l.default({getProductDetailsDB:a.getProductDetailsDB});e.getProductDetailsUsecase=S;let C=c.default({deleteProductDB:a.deleteProductDB});e.deleteProductUsecase=C;let M=d.default({productImportEntity:n.productImportEntity,inserManyDB:s.inserManyDB});e.importProductUsecase=M},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(56);let n=o.productEntityFactory();e.productEntity=n;let s=o.productImportEntityFactory();e.productImportEntity=s},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0)),s=r(1),a=r(2);e.productEntityFactory=function(){return async function({strDocId:t,strName:e,strSKUId:r,strDescription:o,strCategory:s,strBrand:i,dblMRP:u,dblSellingPrice:l,arrImageUrl:c,arrSpecification:d,strStock:f,intPosition:_,arrVariance:y,strOperationType:h,strCreatedTime:S,strCreatedUser:C,strTenantId:M}){try{let b=l,p=u,D=new n.default;if(e||D.add("PRODUCT_NAME_MISSING"),b||y[0]?!b&&y[0]&&(b=y[0].dblSellingPrice,p=y[0].dblMRP?y[0].dblMRP:b):D.add("PRODUCT_PRICE_MISSING"),"UPDATE"!=h||t||D.add("PRODUCT_DOC_ID_MISSING"),c||D.add("IMAGE_URLS_MISSING"),D.isError)throw D;let g=` ${e} ${o||""} ${i||" "} ${s||" "} `;return{strOperationType:h||"SAVE",strDocId:t||null,objProduct:{strTenantId:M||"",strName:e,strSKUId:r||"",strDescription:o,strCategory:s||"Other",strBrand:i||"Other",strStock:f||"S",intPosition:_||0,dblMRP:Number(u)||Number(l),dblSellingPrice:Number(b),strImageUrl:c[0]||null,arrImageUrl:c||{},arrVariance:y||[],arrSpecification:d||[],strKeyWords:g,strCreatedTime:S,strCreatedUser:new a.ObjectID(C)||"",chrStatus:"N"}}}catch(t){throw new n.default(t)}}},e.productImportEntityFactory=function(){return async function({objMasters:t,arrProducts:e,strCreatedTime:r,strCreatedUser:o}){try{let t=[],n=[];return e.forEach(e=>{let i=[];if(e.strName||i.push("PRODUCT_NAME_MISSING"),e.strDescription||i.push("PRODUCT_DISCRIPTION_MISSING"),e.dblSellingPrice||i.push("PRODUCT_PRICE_MISSING"),e.dblTotalStock||i.push("PRODUCT_STOCK_MISSING"),e.arrImageUrl||i.push("IMAGE_URLS_MISSING"),i.length)n.push({...e,arrErrors:i});else{e.strDescription||i.push("DISCRIPTION_MISSING"),e.strBrand||i.push("BRAND_MISSING"),e.strUnit||(e.strUnit="Qty"),e.strTargetType||(e.strTargetType="ALL"),e.dblTotalSales||(e.dblTotalSales=0),e.arrScheme||(e.arrScheme=[]),e.strMaterial||e.strMaterial,e.strGenderCategory||(e.strGenderCategory="ALL"),e.intEstiDeliveryDays||(e.intEstiDeliveryDays=s.INT_ESTIMATE_DELIVERY_DAYS);let t=e.strKeyWords?e.strKeyWords:"";e.strKeyWords=`${t}  \n                        ${e.strName}  ${e.strDescription}  \n                        ${e.strMaterial?e.strMaterial:""}  \n                        ${e.strBrand?e.strBrand:""}  \n                        ${e.strCategory?e.strCategory:""}  \n                        ${e.strSubCategory?e.strSubCategory:""}`}let u=[],l=[];e.arrSizeStock&&e.arrSizeStock.forEach(t=>{u.push({strName:t})}),e.arrColorStock&&e.arrColorStock.forEach(t=>{l.push({strName:t})}),t.push({...e,arrColorStock:l,arrSizeStock:u,arrScheme:[],strImageUrl:e.arrImageUrl[0]||null,dblTotalSales:e.dblTotalSales||0,strCreatedTime:r,strCreatedUser:new a.ObjectID(o)||"",chrStatus:"N"})}),{arrSuccessProducts:t,arrErrorProducts:n}}catch(t){throw new n.default(t)}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(58);let n=o.createProductDBFactory();e.createProductDB=n;let s=o.getListProductDBFactory();e.getListProductDB=s;let a=o.getProductDetailsDBFactory();e.getProductDetailsDB=a;let i=o.deleteProductDBFactory();e.deleteProductDB=i},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(3),s=o(r(0)),a=r(1);e.createProductDBFactory=function(){return async function({objProduct:t}){let e=await n.getMongoDbConnection();try{return await e.collection(a.CLN_PRODUCT).insertOne(t),{strMessage:"Success"}}catch(t){let e={strName:"PRODUCT NAME ALREADY EXIST",strSKUId:"PRODUCT SKU ALREADY EXIST"},r=new s.default;if("MongoError"==t.name&&"11000"==t.code&&(t.keyValue.strName&&r.add(e.strName),t.keyValue.strSKUId&&r.add(e.strSKUId),r.isError))throw r;throw new s.default(t)}}},e.getListProductDBFactory=function(){return async function({blnCount:t=!0,blnCartCount:e=!1,arrQuery:r}){let o=await n.getMongoDbConnection();try{let n=[],s=[];if(e&&(s=await o.collection(a.CLN_PRODUCT).aggregate(r).toArray(),r.pop(),r.pop(),r.pop()),n=await o.collection(a.CLN_PRODUCT).aggregate(r).toArray(),!n.length)return{arrList:n,objCount:[{intTotalCount:0}]};let i=[];return t&&(r.pop(),r.pop(),r.push({$count:"intTotalCount"}),i=await o.collection(a.CLN_PRODUCT).aggregate(r).toArray()),{arrList:s.concat(n),objCount:i}}catch(t){throw new s.default(t)}}},e.getProductDetailsDBFactory=function(){return async function({arrQuery:t}){let e=await n.getMongoDbConnection();try{return e.collection(a.CLN_PRODUCT).aggregate(t).toArray()}catch(t){throw new s.default(t)}}},e.deleteProductDBFactory=function(){return async function({chrStatus:t="D",arrDeleteId:e,strModifiedTime:r,strModifiedUser:o}){let i=await n.getMongoDbConnection();try{if((await i.collection(a.CLN_PRODUCT).find({_id:{$in:e}}).toArray()).length!=e.length)throw new s.default("ITEM_MISMACTH");return await i.collection(a.CLN_PRODUCT).updateMany({_id:{$in:e}},{$set:{chrStatus:t,strModifiedTime:r,strModifiedUser:o}}),{}}catch(t){throw new s.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0)),s=r(2),a=r(4),i=r(1);e.default=function({productEntity:t,createProductDB:e,deleteProductDB:r}){return async function({source:o,body:u}){try{let l=o.strTenantId,c=await t({...u,strCreatedTime:o.timReceived,strCreatedUser:o.strUserId,strTenantId:o.strTenantId});if("UPDATE"==u.strOperationType)return await r({arrDeleteId:[new s.ObjectID(c.strDocId)],chrStatus:"M",strModifiedTime:o.timReceived,strModifiedUser:o.strUserId}),e({objProduct:{...c.objProduct,strTenantId:l}});{let t={$and:[]};t.$and.push({chrStatus:"N"}),t.$and.push({strTenantId:o.strTenantId});let r=await a.getListDB({strCollection:i.CLN_PRODUCT,arrQuery:[{$match:t},{$count:"intTotalCount"}]}),s=r[0]&&r[0].intTotalCount?r[0].intTotalCount:0;if(s=Number(s)+1,console.log("intCount"),console.log(s),console.log("source"),console.log(o),o.intProductCount<=s&&-1!=o.intProductCount)throw new n.default("PRODUCT LIMIT EXEED");return e({objProduct:{...c.objProduct,strTenantId:l}})}}catch(t){throw new n.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0)),s=r(1);e.default=function({getListProductDB:t}){return async function({source:e,body:r}){try{let o={$and:[]};o.$and.push({chrStatus:"N"}),o.$and.push({strTenantId:e.strTenantId}),r.arrBrands&&r.arrBrands.length&&o.$and.push({strBrand:{$in:r.arrBrands}}),r.arrCategory&&r.arrCategory.length&&o.$and.push({strCategory:{$in:r.arrCategory}}),r.arrProductName&&r.arrProductName.length&&o.$and.push({strName:{$in:r.arrProductName}}),r.intAmountLimit&&o.$and.push({dblSellingPrice:{$lte:Number(r.intAmountLimit)}}),r.strStock&&o.$and.push({strStock:r.strStock}),r.strSearch&&o.$and.push({strKeyWords:{$regex:""+r.strSearch,$options:"i"}});let n=[];if(n.push({$match:o}),r.strSort){let t={$sort:{[r.strSort]:"ASC"==r.strSortActive?1:-1}};n.push(t)}let a=Number(r.intPageNo)*Number(r.intLimit);await n.push({$limit:a+Number(r.intLimit)||50}),await n.push({$skip:a||0});let i={};return i=await t({strTenantId:e.strTenantId||s.STR_COMMON_DB_TENANT_ID,arrQuery:n}),{...r,intTotalCount:i.objCount[0].intTotalCount||0,arrList:i.arrList}}catch(t){throw new n.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0)),s=r(1),a=r(2);e.default=function({getProductDetailsDB:t}){return async function({source:e,body:r}){try{if(!r.strProductId)throw new n.default("PRODUCT_ID_MISSING");let o={chrStatus:"N",_id:new a.ObjectId(r.strProductId)},i=[];i.push({$match:o});let u=[];return u="COMMON"==r.strTargetType?await t({strTenantId:s.STR_COMMON_DB_TENANT_ID,arrQuery:i}):await t({strTenantId:e.strTenantId,arrQuery:i}),{...r,...u[0]}}catch(t){throw new n.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(6),s=o(r(0)),a=r(1),i=r(2);e.default=function({deleteProductDB:t}){return async function({source:e,body:r}){try{let o=[];return r.arrDeleteId.forEach(t=>{o.push(new i.ObjectID(t))}),"COMMON"==r.strTargetType&&await t({arrDeleteId:o,strTenantId:a.STR_COMMON_DB_TENANT_ID,strModifiedTime:e.timReceived,strModifiedUser:e.strUserId}),await t({arrDeleteId:o,strCollection:n.CLN_USER,strTenantId:e.strTenantId,strModifiedTime:e.timReceived,strModifiedUser:e.strUserId}),{strMessage:"DELETE_SUCCESS"}}catch(t){throw new s.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0)),s=r(1);e.default=function({productImportEntity:t,inserManyDB:e}){return async function({source:r,body:o}){try{let n=await t({...o,strCreatedTime:r.timReceived,strCreatedUser:r.strUserId});return await e({strTenantId:r.strTenantId,strCollection:s.CLN_PRODUCT,arrInsertDocuments:n.arrSuccessProducts}),{arrErrorProducts:n.arrErrorProducts,arrSuccessProducts:n.arrSuccessProducts}}catch(t){throw new n.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0)),s=r(1),a=r(2);e.default=function({getListProductDB:t,getListDB:e}){return async function({source:r,body:o}){try{let n={$and:[]};n.$and.push({chrStatus:"N"}),n.$and.push({strTenantId:r.strTenantId}),o.arrBrands&&o.arrBrands.length&&n.$and.push({strBrand:{$in:o.arrBrands}}),o.arrCategory&&o.arrCategory.length&&n.$and.push({strCategory:{$in:o.arrCategory}}),o.arrProductName&&o.arrProductName.length&&n.$and.push({strName:{$in:o.arrProductName}}),o.intAmountLimit&&n.$and.push({dblSellingPrice:{$lte:Number(o.intAmountLimit)}}),o.strSearch&&n.$and.push({strKeyWords:{$regex:""+o.strSearch,$options:"i"}}),o.strStock&&n.$and.push({strStock:o.strStock});let i=[];if(i.push({$match:n}),o.strSort){let t={$sort:{[o.strSort]:"ASC"==o.strSortActive?1:-1}};i.push(t)}let u=Number(o.intPageNo)*Number(o.intLimit);await i.push({$limit:u+Number(o.intLimit)||50}),await i.push({$skip:u||0}),await i.push({$lookup:{from:s.CLN_CART,localField:"_id",foreignField:"strProductId",as:"objCart"}}),i.push({$unwind:"$objCart"}),i.push({$match:{"objCart.strUserId":new a.ObjectId(r.strUserId)}});let l={},c=[];l=await t({blnCartCount:!0,arrQuery:i});let d=new Set,f=[],_=Number(l.objCount[0].intTotalCount)||0;l.arrList.forEach(t=>{if(d.has(t._id.toString())){let e=f.indexOf(t._id.toString());c[e].dblCartCount=(c[e]&&c[e].dblCartCount?Number(c[e].dblCartCount):0)+(t.objCart&&t.objCart.dblQty?Number(t.objCart.dblQty):0),--_}else{d.add(t._id.toString()),f.push(t._id.toString());let e=t.objCart&&t.objCart.dblQty?t.objCart.dblQty:0;delete t.objCart,c.push({dblCartCount:e,...t})}});let y=await e({strCollection:s.CLN_CART,arrQuery:[{$match:{$and:[{chrStatus:"N"},{strTenantId:r.strTenantId},{strUserId:new a.ObjectId(r.strUserId)}]}},{$count:"intCartCount"}]});return{...o,...y[0],intTotalCount:_,arrList:c}}catch(t){throw new n.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0)),s=r(4),a=r(1),i=r(2);e.createProductControllerFactory=function({createProductUsecase:t}){return async function({body:e,...r}){try{let o=await s.getOneDB({strCollection:a.CLN_USER,objQuery:{_id:new i.ObjectId(r.strUserId)}});console.log(o);let n=o.strPlan&&a.objPlan[o.strPlan]?o.strPlan:"DEMO",u=a.objPlan[n];return{body:await t({source:{...r,...u},body:e})}}catch(t){return new n.default(t).send()}}},e.getListProductControllerFactory=function({getListProductUsecase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}},e.getListProductCartControllerFactory=function({getListProductCartUsecase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}},e.getProductDetailsControllerFactory=function({getProductDetailsUsecase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}},e.importProductControllerFactory=function({importProductUsecase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}},e.deleteProductControllerFactory=function({deleteProductUsecase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(5)),s=r(3),a=r(67);let i=n.default.Router();i.post("/get_master",s.makeController(a.getListMasterController)),t.exports=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(68),n=r(76);let s=n.createMasterControllerFactory({createMasterUsecase:o.createMasterUsecase});e.createMasterController=s;let a=n.getListMasterControllerFactory({getListMasterUsecase:o.getListMasterUsecase});e.getListMasterController=a;let i=n.deleteMasterControllerFactory({deleteMasterUsecase:o.deleteMasterUsecase});e.deleteMasterController=i},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(69),s=r(71),a=o(r(73)),i=o(r(74)),u=o(r(75));let l=a.default({getListMasterDB:n.getListMasterDB});e.getListMasterUsecase=l;let c=i.default({masterEntity:s.masterEntity,deleteMasterDB:n.deleteMasterDB,createMasterDB:n.createMasterDB});e.createMasterUsecase=c;let d=u.default({deleteMasterDB:n.deleteMasterDB});e.deleteMasterUsecase=d},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(70);let n=o.createMasterDBFactory();e.createMasterDB=n;let s=o.getListMasterDBFactory();e.getListMasterDB=s;let a=o.deleteMasterDBFactory();e.deleteMasterDB=a},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(3),s=o(r(0));e.createMasterDBFactory=function(){return async function({strCollection:t,objMaster:e}){let r=await n.getMongoDbConnection();try{return await r.collection(t).insertOne(e),{strMessage:"Success"}}catch(t){let e={strName:"ITEM NAME ALREADY EXIST"},r=new s.default;if("MongoError"==t.name&&"11000"==t.code&&(t.keyValue.strName&&r.add(e.strName),r.isError))throw r;throw new s.default(t)}}},e.getListMasterDBFactory=function(){return async function({strCollection:t,arrQuery:e}){let r=await n.getMongoDbConnection();try{return r.collection(t).aggregate(e).toArray()}catch(t){throw new s.default(t)}}},e.deleteMasterDBFactory=function(){return async function({chrStatus:t="D",strCollection:e,arrDeleteId:r,strModifiedTime:o,strModifiedUser:a}){let i=await n.getMongoDbConnection();try{if((await i.collection(e).find({_id:{$in:r}}).toArray()).length!=r.length)throw new s.default("ITEM_MISMACTH");return await i.collection(e).updateMany({_id:{$in:r}},{$set:{chrStatus:t,strModifiedTime:o,strModifiedUser:a}}),{}}catch(t){throw new s.default(t)}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});let o=r(72).masterEntityFactory();e.masterEntity=o},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0)),s=r(2);e.masterEntityFactory=function(){return async function({strTenantId:t,strDocId:e,strName:r,strImgUrl_0:o,strCollection:a,strOperationType:i,objExtras:u,strCreatedTime:l,strCreatedUser:c}){try{let d=new n.default;if(r||d.add("MASTER_NAME_MISSING"),a||d.add("MASTER_COLLECTION_MISSING"),"UPDATE"!=i||e||d.add("MASTER_DOC_ID_MISSING"),d.isError)throw d;return{strOperationType:i||"SAVE",strDocId:e,strCollection:a,objMaster:{strTenantId:t,strName:r,strImgUrl_0:o,strCreatedTime:l,strCreatedUser:new s.ObjectID(c)||"",chrStatus:"N",...u||{}}}}catch(t){throw new n.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0));e.default=function({getListMasterDB:t}){return async function({source:e,body:r}){try{let o={};if(!r.arrCollection)throw new n.default("INVALID_COLLECTION","errCommon");for(let s of r.arrCollection){if(!s.strCollection)throw new n.default("COLLECTION_NAME_MISSING");let a={$and:[]};a.$and.push({chrStatus:"N"}),a.$and.push({strTenantId:e.strTenantId}),s.objCondition&&a.$and.push(s.objCondition),s.strSearch&&a.$and.push({strName:{$regex:""+s.strSearch,$options:"i"}});let i=[];if(i.push({$match:a}),r.strSort){let t={$sort:{[r.strSort]:"ASC"==r.strSortActive?1:-1}};i.push(t)}await i.push({$limit:s.intLimit?Number(s.intLimit):10}),o[s.strCollection]=await t({strTenantId:e.strTenantId,strCollection:s.strCollection,arrQuery:i})}return o}catch(t){throw new n.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(6),s=o(r(0)),a=r(2),i=r(4);e.default=function({masterEntity:t,deleteMasterDB:e,createMasterDB:r}){return async function({source:o,body:u}){try{let l=await t({...u,strCreatedTime:o.timReceived,strCreatedUser:o.strUserId,strTenantId:o.strTenantId});if("UPDATE"==u.strOperationType)return await e({arrDeleteId:[new a.ObjectID(l.strDocId)],chrStatus:"M",strCollection:u.strCollection,strModifiedTime:o.timReceived,strModifiedUser:o.strUserId}),r({strCollection:l.strCollection,objMaster:l.objMaster});if(l.strCollection==n.CLN_CATEGORY){let t={$and:[]};t.$and.push({chrStatus:"N"}),t.$and.push({strTenantId:o.strTenantId});let e=await i.getListDB({strCollection:n.CLN_CATEGORY,arrQuery:[{$match:t},{$count:"intTotalCount"}]}),a=e[0]&&e[0].intTotalCount?e[0].intTotalCount:0;if(a=Number(a)+1,console.log("sou"),console.log(o),console.log("intCount"),console.log(a),o.intCategoryCount<=a&&-1!=o.intCategoryCount)throw new s.default("CATEGORY LIMIT EXCEED");return r({strCollection:l.strCollection,objMaster:l.objMaster})}return r({strCollection:l.strCollection,objMaster:l.objMaster})}catch(t){throw new s.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0)),s=r(1),a=r(2);e.default=function({deleteMasterDB:t}){return async function({source:e,body:r}){try{if(!r.strCollection)throw new n.default("INVALID_COLLECTION");let o=[];return r.arrDeleteId.forEach(t=>{o.push(new a.ObjectID(t))}),"COMMON"==r.strTargetType&&await t({arrDeleteId:o,strTenantId:s.STR_COMMON_DB_TENANT_ID,strCollection:r.strCollection,strModifiedTime:e.timReceived,strModifiedUser:e.strUserId}),await t({arrDeleteId:o,strTenantId:e.strTenantId,strCollection:r.strCollection,strModifiedTime:e.timReceived,strModifiedUser:e.strUserId}),{strMessage:"DELETE_SUCCESS"}}catch(t){throw new n.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0)),s=r(4),a=r(1),i=r(2);e.createMasterControllerFactory=function({createMasterUsecase:t}){return async function({body:e,...r}){try{let o=await s.getOneDB({strCollection:a.CLN_USER,objQuery:{_id:new i.ObjectId(r.strUserId)}});console.log(o);let n=o.strPlan&&a.objPlan[o.strPlan]?o.strPlan:"DEMO",u=a.objPlan[n];return{body:await t({source:{...r,...u},body:e})}}catch(t){return new n.default(t).send()}}},e.getListMasterControllerFactory=function({getListMasterUsecase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}},e.deleteMasterControllerFactory=function({deleteMasterUsecase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(5)),s=r(3),a=r(78);let i=n.default.Router();i.post("/get_module_settings",s.makeController(a.getModuleSttingsController)),i.post("/get_autocomplete",s.makeController(a.getAutoCompleteController)),t.exports=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(79),n=r(80),s=r(81),a=r(82);let i=o.fileUploadeToS3ControllerFactory();e.fileUploadeToS3Controller=i;let u=n.getModuleSttingsControllerFactory({getModuleSettingsUsecase:a.getModuleSettingsUsecase});e.getModuleSttingsController=u;let l=s.getAutoCompleteControllerFactory({getAutoCompleteUsecase:a.getAutoCompleteUsecase});e.getAutoCompleteController=l;let c=n.createModuleSttingsControllerFactory({createModuleSettingsUsecase:a.createModuleSettingsUsecase});e.createModuleSttingsController=c},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0)),s=r(3);e.fileUploadeToS3ControllerFactory=function(){return async function({body:t,files:e,...r}){try{let r;if(!e.images)throw new n.default("FILES_MISSING","errModuleWise");return r=e.images.length>=2?await s.multiFilesToS3({arrFiles:e.images,strQuality:!!t.strQuality&&Number(t.strQuality),strType:t.strType||"",strFileNames:t.strFileNames?t.strFileNames:""}):await s.multiFilesToS3({arrFiles:[e.images],strQuality:!!t.strQuality&&Number(t.strQuality),strType:t.strType||"",strFileNames:t.strFileNames?t.strFileNames:""}),{body:r}}catch(t){return new n.default(t).send()}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0));e.getModuleSttingsControllerFactory=function({getModuleSettingsUsecase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}},e.createModuleSttingsControllerFactory=function({createModuleSettingsUsecase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0));e.getAutoCompleteControllerFactory=function({getAutoCompleteUsecase:t}){return async function({body:e,...r}){try{return{body:await t({source:r,body:e})}}catch(t){return new n.default(t).send()}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(83),s=r(4),a=o(r(85)),i=o(r(86)),u=o(r(87));let l=a.default({getModuleSettingsDB:n.getModuleSettingsDB});e.getModuleSettingsUsecase=l;let c=i.default({getAutoCompleteDB:n.getAutoCompleteDB});e.getAutoCompleteUsecase=c;let d=u.default({updateOneDB:s.updateOneDB,inserOneDB:s.inserOneDB});e.createModuleSettingsUsecase=d},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(84);let n=o.getModuleSettingsDBFactory();e.getModuleSettingsDB=n;let s=o.getAutoCompleteDBFactory();e.getAutoCompleteDB=s},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(3),s=o(r(0)),a=r(1);e.getModuleSettingsDBFactory=function(){return async function({objQuery:t}){let e=await n.getMongoDbConnection();try{return e.collection(a.CLN_MODULE_SETTINGS).findOne(t)}catch(t){throw new s.default(t)}}},e.getAutoCompleteDBFactory=function(){return async function({strCollection:t,objQuery:e}){let r=await n.getMongoDbConnection();try{return r.collection(t).find(e).toArray()}catch(t){throw new s.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0));e.default=function({getModuleSettingsDB:t}){return async function({source:e,body:r}){try{if(!r.strName)throw new n.default("INVALID_MODULE_NAME");let o={chrStatus:"N",strName:r.strName,strTenantId:e.strTenantId};return{...await t({strTenantId:e.strTenantId,objQuery:o}),strName:r.strName}}catch(t){throw new n.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(0));e.default=function({getAutoCompleteDB:t}){return async function({source:e,body:r}){try{if(!r.strCollection)throw new n.default("INVALID_MODULE_NAME");let o={$and:[{strName:{$regex:""+r.strValue,$options:"i"}},{chrStatus:"N"},{strTenantId:e.strTenantId}]};return r.objCondition&&o.$and.push(r.objCondition),{arrList:await t({strCollection:r.strCollection,strTenantId:e.strTenantId,objQuery:o})}}catch(t){throw new n.default(t)}}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(1),s=o(r(0)),a=r(2);e.default=function({updateOneDB:t,inserOneDB:e}){return async function({source:r,body:o}){try{if(!o.objSettings&&o.objSettings.strName)throw new s.default("MODULE_NAME_MISSING");if("UPDATE"==o.strOperationType){if(!o._id)throw new s.default("DOC_ID_MISSING");delete o.objSettings._id;await t({strCollection:n.CLN_MODULE_SETTINGS,objDocument:{strTenantId:r.strTenantId,...o.objSettings},objQuery:{_id:new a.ObjectID(o._id)}})}else await e({strCollection:n.CLN_MODULE_SETTINGS,objDocument:{strTenantId:r.strTenantId,...o.objSettings}});return{strMessage:"Success"}}catch(t){throw new s.default(t)}}}},function(t,e,r){"use strict";function o(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),o(r(89)),o(r(90)),o(r(91))},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(3),s=r(1),a=o(r(0));e.jwtTokenChecking=async function(t,e,r){let o={"Content-Type":"application/json","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))};try{let i=await t.headers["x-access-token"]||t.headers.authorization;if(!i)return e.status(401).set(o).send(new a.default("AUTHORIZATION_TOKEN_HEADER_IS_MISSING").send().body);{let u=i,l=await n.getRedisData(u);if(t.strTenantId=l,t.strToken=u,!l)return e.status(401).set(o).send(new a.default("INVALID_TOKEN_PROVIDED").send().body);{let e={issuer:"CARTME",subject:"123",audience:s.STR_COMMON_DB_TENANT_ID},o=await n.jwtVerify(u,e);t.strUserId=o.strUserId,t.strType=o.strType,r()}}}catch(t){return e.status(401).set(o).send(new a.default(t).send().body)}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(3),s=r(1),a=o(r(0));e.jwtTokenDecode=async function(t,e,r){let o={"Content-Type":"application/json","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))};try{let e=t.headers["x-access-token"]||t.headers.authorization,o=t.headers.strappinfo||null;if(console.log(t.path),e){let a=await n.getRedisData(e);if(t.strTenantId=a,t.strToken=e,a){let o={issuer:"CARTME",subject:"123",audience:s.STR_COMMON_DB_TENANT_ID},a=await n.jwtVerify(e,o);t.strUserId=a.strUserId,t.strType=a.strType,r()}else o?(t.strTenantId=o,r()):o||"/user/login_user"!=t.path||(console.log(t.path),console.log("req"),r())}else o&&(t.strTenantId=o,r())}catch(t){return e.status(401).set(o).send(new a.default(t).send().body)}}},function(t,e,r){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(1),s=r(92),a=r(4),i=o(r(0));e.sessionValidator=async function(t,e,r){let o={"Content-Type":"application/json","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))};try{let e=await t.headers.strappinfo,i=await t.headers.strtoken;t.strTenantId=e;await t.hostname;if(i){let u=await a.getOneDB({strCollection:n.CLN_USER,objSet:{strLastUpdate:o["Last-Modified"],strTenantId:e},objQuery:{strToken:i,chrStatus:"N",strTenantId:e}});if(t.strToken=i,u&&u._id)console.log("EXISTS"),t.strUserId=u._id;else{console.log("NOT EXISTS");let r=`${e}-${s.v4()}`;console.log(r);let i=await a.inserOneDB({strCollection:n.CLN_USER,objDocument:{strToken:r,strType:n.USER_USER,strLastUpdate:o["Last-Modified"],strCreateTime:o["Last-Modified"],strTenantId:e,strMobileNo:"",chrStatus:"N",objDetails:{}}});t.strUserId=i.insertedId,t.strToken=r}r()}else{console.log("TOKEN NOT EXISTS");let i=`${e}-${s.v4()}`;console.log(i);let u=await a.inserOneDB({strCollection:n.CLN_USER,objDocument:{strToken:i,strType:n.USER_USER,strLastUpdate:o["Last-Modified"],strCreateTime:o["Last-Modified"],strTenantId:e,strMobileNo:"",objDetails:{}}});t.strUserId=u.insertedId,t.strToken=i,r()}}catch(t){return e.status(401).set(o).send(new i.default(t).send().body)}}},function(t,e){t.exports=require("uuid")}]);